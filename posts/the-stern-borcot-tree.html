<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <title>스턴 브로콧 트리(Stern Brocot tree) | Gumgood Blog</title>
  
  <meta name="description" content="스턴 브로콧 트리 소개 및 연습문제">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="스턴 브로콧 트리(Stern Brocot tree)">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://gumgood.github.io/posts/the-stern-borcot-tree">
  <meta property="og:description" content="스턴 브로콧 트리 소개 및 연습문제">
  <meta property="og:site_name" content="Gumgood Blog">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://gumgood.github.io/posts/the-stern-borcot-tree">
  <meta name="twitter:title" content="스턴 브로콧 트리(Stern Brocot tree)">
  <meta name="twitter:description" content="스턴 브로콧 트리 소개 및 연습문제">

  
    <meta property="og:image" content="https://gumgood.github.io/assets/og-image.jpg">
    <meta name="twitter:image" content="https://gumgood.github.io/assets/og-image.jpg">
  

  <link href="https://gumgood.github.io/feed.xml" type="application/rss+xml" rel="alternate" title="Gumgood Blog Last 10 blog posts" />

  

  

    
      <link rel="icon" type="image/x-icon" href="/assets/favicon-light.ico">
      <link rel="apple-touch-icon" href="/assets/apple-touch-icon-light.png">
      <link rel="stylesheet" type="text/css" href="/assets/light.css">
    

  

  <!-- mathjax support-->
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      }
    },
    tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$'] ],
      processEscapes: true,
    }
});
MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
      alert("Math Processing Error: "+message[1]);
    });
MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
      alert("Math Processing Error: "+message[1]);
    });
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  <!-- code highlight -->
  <link href="/assets/syntax.css" rel="stylesheet">

  <!-- google ananlytics -->
  <meta name="google-site-verification" content="keI0ZBFx59S-ScMR-4FTc81bsVJ6UTXq8JfKhsYZqsM" />

  <!-- naver search advisor -->
  <meta name="naver-site-verification" content="c3b1241687be8818c49d73438e224864dadc03e7" />

</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav scrollappear">
  <a href="/" class="header-logo" title="Gumgood Blog">Gumgood Blog</a>
  <ul class="header-links">
    
      <li>
        <a href="/about" title="About me">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-about">
  <use href="/assets/about.svg#icon-about" xlink:href="/assets/about.svg#icon-about"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
      <li>
        <a href="https://github.com/gumgood" rel="noreferrer noopener" target="_blank" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-github">
  <use href="/assets/github.svg#icon-github" xlink:href="/assets/github.svg#icon-github"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      <li>
        <a href="mailto:idealwon7700@gmail.com" title="Email">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-email">
  <use href="/assets/email.svg#icon-email" xlink:href="/assets/email.svg#icon-email"></use>
</svg>

        </a>
      </li>
    
    
    
  </ul>
</nav>


  <ul class="header-tags scrollappear">
    
    
      
        <li><a href="/tag/algorithm">Algorithm</a></li>
    
      
        <li><a href="/tag/editorial">Editorial</a></li>
    
      
        <li><a href="/tag/trick">Trick</a></li>
    
  </ul>


        <article class="article scrollappear">
          <header class="article-header">
            <h1>스턴 브로콧 트리(Stern Brocot tree)</h1>
            <p>스턴 브로콧 트리 소개 및 연습문제</p>
            <div class="article-list-footer">
  <span class="article-list-date">
    January 23, 2021
  </span>
  <span class="article-list-divider">-</span>
  <span class="article-list-minutes">
    
    
      4 minute read
    
  </span>
  <span class="article-list-divider">-</span>
  <div class="article-list-tags">
    
      
      <a href="/tag/algorithm" title="See all posts with tag 'Algorithm'">Algorithm</a>
    
  </div>
</div>
          </header>

          <div class="article-content">
            <p>먼저, 모든 양의 분수를 나열하는 방법에 대해 알아봅시다. 다음 두 분수가 있습니다.</p>

<script type="math/tex; mode=display">\dfrac{0}{1}, \dfrac{1}{0}</script>

<p>두 번째는 엄밀히 분수는 아니지만, 무한대를 나타내는 기약분수로 해석합시다.</p>

<p>매 반복마다, 모든 인접한 분수 $\dfrac{a}{b}$ 와 $\dfrac{c}{d}$ 사이에 <strong>mediant</strong>인 $\dfrac{a+c}{b+d}$를 삽입합니다. 반복에 따라 다음과 같이 나열됩니다.</p>

<script type="math/tex; mode=display">\begin{array}{c}
    \dfrac{0}{1}, \dfrac{1}{1}, \dfrac{1}{0} \\\\
    \dfrac{0}{1}, \dfrac{1}{2}, \dfrac{1}{1}, \dfrac{2}{1}, \dfrac{1}{0} \\\\
    \dfrac{0}{1}, \dfrac{1}{3}, \dfrac{1}{2}, \dfrac{2}{3}, \dfrac{1}{1}, \dfrac{3}{2}, \dfrac{2}{1}, \dfrac{3}{1}, \dfrac{1}{0}
    \end{array}</script>

<p>이를 무한히 반복하면 모든 양의 분수를 나열하게 됩니다. 각 분수들은 오름차순으로 나타나며, 기약분수꼴이기 때문에 유일하게 등장합니다.</p>

<p>이 원리를 증명하기 전에 스턴 브로콧 트리가 어떻게 표현되는지 봅시다. 모든 분수는 트리 상에서 두 자식을 가집니다. 각 자식은 왼쪽에서 가장 가까운 조상과의 <strong>mediant</strong>, 오른쪽에서 가장 가까운 조상과의 <strong>mediant</strong>입니다.</p>

<p><img src="../assets/postimg/2021-01-23-the-stern-borcot-tree/1024px-SternBrocotTree.svg.png" alt="" /></p>

<p>스턴 브로콧 트리를 중위순회했을 때, 위에서 나열한 분수를 순서대로 만날 수 있습니다.</p>

<h3 id="증명">증명</h3>

<hr />

<p>이 일련의 분수들이 오름차순이고, 기약분수이며, 모든 분수를 포함한다는 사실을 증명해봅시다(건너뛰어도 됩니다).</p>

<p><strong>오름차순</strong> 오름차순 증명은 간답합니다. 두 분수의 <strong>mediant</strong>는 항상 그 사이 값을 가지므로</p>

<script type="math/tex; mode=display">\dfrac{a}{b} \le \dfrac{a+c}{b+d} \le \dfrac{c}{d}</script>

<p>다음이 성립합니다</p>

<script type="math/tex; mode=display">\dfrac{a}{b} \le \dfrac{c}{d}</script>

<p>두 부등식은 통분하면 쉽게 보일 수 있습니다. 처음 두 분수가 오름차순을 만족하기 때문에 <strong>mediant</strong>를 삽입을 반복하더라도 오름차순이 유지됩니다.</p>

<p><strong>기약분수</strong> 어떤 인접한 분수 $\dfrac{a}{b}$ 와 $\dfrac{c}{d}$에 대해 다음을 보임으로써 기약분수성을 증명하겠습니다.</p>

<script type="math/tex; mode=display">bc - ad = 1</script>

<p>$ax+by=c$꼴의 디오판틴방정식은 $c \mid gcd(a,b)$일 때 해를 가지게 됩니다. 위의 식의 경우 $\gcd(a,b) = \gcd(c,d) = 1$를 의미하고, 이는 기약분수임을 보이는 것과 같습니다.</p>

<p>처음 두 분수는 자명하게 $bc - ad = 1$임이 자명합니다. 따라서 <strong>mediant</strong>들이 이 조건을 따르는지 보이면 됩니다.</p>

<p>두 인접한 분수가 $bc - ad = 1$를 만족한다고 가정했을 때, <strong>mediant</strong>를 추가한 후</p>

<script type="math/tex; mode=display">\dfrac{a}{b}, \dfrac{a+c}{b+d}, \dfrac{c}{d}</script>

<p>다음과 같은 식이 성립해야 하며</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
    b(a+c) - a(b+d) &= 1 \\
    c(b+d) - d(a+c) &= 1
\end{aligned} %]]></script>

<p>이는 $bc - ad = 1$로 쉽게 보일 수 있습니다.</p>

<p>따라서 모든 분수에 대해 위의 식이 항상 성립하고, 모든 분수는 기약분수임을 증명할 수 있습니다.</p>

<p><strong>모든 분수의 등장</strong> 각 분수가 스턴 브로콧 트리에서 어디에 위치하는지 알아봅시다. 왼쪽 서브트리의 분수들은 부모의 분수보다 작고, 오른쪽 서브트리의 분수들은 부모의 분수보다 큽니다. 따라서 어떤 분수를 찾으려면 루트로부터 내려가면서 찾으려는 분수보다 작으면 왼쪽, 크면 오른쪽으로 이동해야합니다.</p>

<p>임의의 양의 분수 $\dfrac{x}{y}$를 찾는다고 해봅시다. 이 분수는 분명히 $\dfrac{0}{1}$와 $\dfrac{1}{0}$사이에 존재합니다. 따라서 트리를 무한히 내려가도 안 나오는 경우를 빼면, 모두 트리 상에 존재합니다.</p>

<p>그렇다면 유한하게 내려갔을 때, $\dfrac{x}{y}$가 등장함을 보이겠습니다.</p>

<p>트리를 내려가는 동안 두 자식에 대해 다음이 성립합니다.</p>

<script type="math/tex; mode=display">\dfrac{a}{b} \lt \dfrac{x}{y} \lt \dfrac{c}{d}</script>

<p>정수에서 $z \gt 0 \iff z \ge 1$임을 이용하여 식을 정리합니다.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
    bx - ay &\ge 1 \\
    cy - dx &\ge 1
\end{aligned} %]]></script>

<p>첫 번째 식에 $c+d$, 두 번째 식에 $a+b$를 곱해 다음 식을 얻을 수 있습니다.</p>

<script type="math/tex; mode=display">(c+d)(bx - ay) + (a+b)(cy - dx) \ge a+b+c+d</script>

<p>위에서 보였던 $bc-ad=1$을 적용합니다.</p>

<script type="math/tex; mode=display">x+y \ge a+b+c+d</script>

<p>트리를 내려갈 때마다 $a,b,c,d$ 중 최소 하나는 값이 증가하기 때문에 $x+y$번 안에 해당 분수를 찾을 수 있습니다. 따라서 모든 분수는 이 트리 안에 존재하게 됩니다.</p>

<h2 id="구현">구현</h2>

<hr />

<p>스턴 브로콧 트리에서 어떤 서브트리를 만드려면 왼쪽 조상과 오른쪽 조상을 알아야 합니다. 처음 레벨에서 각 조상은 $\dfrac{0}{1}$과 $\dfrac{1}{0}$입니다. 각 레벨에서 <strong>mediant</strong>를 계산하면, 이 값은 왼쪽 서브트리의 오른쪽 조상, 오른쪽 서브트리의 왼쪽 조상이 됩니다.</p>

<p>다음은 스턴 브로콧 트리를 만드는 pseudo code입니다.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="kt">int</span> <span class="n">lv</span> <span class="o">=</span> <span class="mi">1</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span>
    <span class="c1">// output the current fraction x/y at the current level in the tree</span>
    <span class="n">build</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lv</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">build</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">lv</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>정의상 깊이가 무한하기 때문에 실제로 쓰이는 코드는 아니고, PS에서는 어떻게 쓰이는지 알아봅시다.</p>

<h2 id="분수-탐색-알고리즘">분수 탐색 알고리즘</h2>

<hr />

<p>스턴 브로콧 트리는 무한 완전 이진탐색 트리입니다. 따라서 이진 탐색 트리에서 원소를 찾는 방법을 그대로 적용할 수 있습니다. 현재 노드의 분수보다 찾으려는 분수가 작은 경우 왼쪽 자식으로, 큰 경우 오른쪽 자식으로 내려갑니다. 분수를 찾을 때까지 트리를 내려가면 됩니다.</p>

<p>분수 $\dfrac{x}{y}$를 찾기 위해 내려간 경로를 반환하는 코드입니다. 모든 분수에 대해 이 경로는 유일하게 존재합니다.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="n">string</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">m</span> <span class="o">&amp;&amp;</span> <span class="n">y</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="sc">'L'</span> <span class="o">+</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="sc">'R'</span> <span class="o">+</span> <span class="n">find</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="연습문제">연습문제</h2>

<hr />

<ul>
  <li>추가 예정</li>
</ul>

          </div>
          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=%EC%8A%A4%ED%84%B4+%EB%B8%8C%EB%A1%9C%EC%BD%A7+%ED%8A%B8%EB%A6%AC(Stern+Brocot+tree)%20-%20https://gumgood.github.io/posts/the-stern-borcot-tree" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://gumgood.github.io/posts/the-stern-borcot-tree" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
          </div>

          
            <div id="disqus_thread" class="article-comments"></div>
            <script src="https://gumgood-blog.disqus.com/embed.js" async defer></script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
          
        </article>
        <footer class="footer scrollappear">
  <p>
    Published by
    <a href="/about" title="About me">gumgood</a>.
  </p>
</footer>

      </div>
    </div>
  </main>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-P2YZRWZP3K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-P2YZRWZP3K');
  </script>


<script src="/assets/vendor.js" type="text/javascript"></script>


  <script src="/assets/webfonts.js" type="text/javascript"></script>



  <script src="/assets/scrollappear.js" type="text/javascript"></script>


<script src="/assets/application.js" type="text/javascript"></script>


</body>
</html>
